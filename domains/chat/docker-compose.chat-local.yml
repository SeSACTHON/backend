services:
  chat:
    build:
      context: ../..
      dockerfile: domains/chat/Dockerfile
    container_name: chat-local-api
    environment:
      # OpenAI API 키 (필수)
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      # 로깅
      ENVIRONMENT: dev
      LOG_LEVEL: DEBUG
      LOG_FORMAT: json
      # CORS (로컬 테스트용)
      CHAT_CORS_ORIGINS: '["http://localhost:3000","http://localhost:5173"]'
    ports:
    - 8003:8000
    healthcheck:
      test: [CMD, python, -c, import urllib.request; urllib.request.urlopen('http://localhost:8000/health')]
      interval: 10s
      timeout: 5s
      retries: 3
