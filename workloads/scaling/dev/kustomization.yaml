# KEDA ScaledObject 및 Prometheus Adapter HPA (Dev)
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
metadata:
  name: scaling-dev

resources:
- ../base

# Dev 환경: 낮은 스케일링 한계
patches:
# scan-worker: 최대 3개 (k8s-worker-ai 노드 자원 제한)
- target:
    kind: ScaledObject
    name: scan-worker-scaledobject
  patch: |-
    - op: replace
      path: /spec/maxReplicaCount
      value: 3
    - op: replace
      path: /spec/minReplicaCount
      value: 1

# scan-api: 최대 3개
- target:
    kind: HorizontalPodAutoscaler
    name: scan-api-hpa
  patch: |-
    - op: replace
      path: /spec/maxReplicas
      value: 3
    - op: replace
      path: /spec/minReplicas
      value: 1
