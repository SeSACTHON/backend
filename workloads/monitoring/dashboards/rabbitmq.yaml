# RabbitMQ Î™®ÎãàÌÑ∞ÎßÅ ÎåÄÏãúÎ≥¥Îìú
# Î™©Ï†Å: Î©îÏãúÏßÄ ÌÅê, Ïª§ÎÑ•ÏÖò, Î©îÎ™®Î¶¨ ÏÇ¨Ïö©Îüâ Ï∂îÏ†Å
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-rabbitmq
  namespace: prometheus
  labels:
    grafana_dashboard: '1'
    app: grafana
  annotations:
    grafana_folder: Infrastructure
data:
  rabbitmq.json: |
    {
      "title": "üê∞ RabbitMQ - Message Queue",
      "uid": "rabbitmq-overview",
      "version": 1,
      "timezone": "browser",
      "schemaVersion": 38,
      "refresh": "10s",
      "time": { "from": "now-30m", "to": "now" },
      "panels": [
        {
          "title": "üìä Overview",
          "type": "row",
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
          "collapsed": false
        },
        {
          "title": "Ready Messages",
          "type": "stat",
          "gridPos": { "h": 4, "w": 4, "x": 0, "y": 1 },
          "targets": [
            {
              "expr": "sum(rabbitmq_queue_messages_ready{namespace=\"rabbitmq\"})",
              "legendFormat": "Ready"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short",
              "decimals": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "color": "green", "value": null },
                  { "color": "yellow", "value": 100 },
                  { "color": "red", "value": 1000 }
                ]
              }
            }
          }
        },
        {
          "title": "Unacked Messages",
          "type": "stat",
          "gridPos": { "h": 4, "w": 4, "x": 4, "y": 1 },
          "targets": [
            {
              "expr": "sum(rabbitmq_queue_messages_unacked{namespace=\"rabbitmq\"})",
              "legendFormat": "Unacked"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short",
              "decimals": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "color": "green", "value": null },
                  { "color": "yellow", "value": 50 },
                  { "color": "red", "value": 200 }
                ]
              }
            }
          }
        },
        {
          "title": "Connections",
          "type": "stat",
          "gridPos": { "h": 4, "w": 4, "x": 8, "y": 1 },
          "targets": [
            {
              "expr": "rabbitmq_connections{namespace=\"rabbitmq\"}",
              "legendFormat": "Connections"
            }
          ],
          "fieldConfig": { "defaults": { "unit": "short", "decimals": 0 } }
        },
        {
          "title": "Channels",
          "type": "stat",
          "gridPos": { "h": 4, "w": 4, "x": 12, "y": 1 },
          "targets": [
            {
              "expr": "rabbitmq_channels{namespace=\"rabbitmq\"}",
              "legendFormat": "Channels"
            }
          ],
          "fieldConfig": { "defaults": { "unit": "short", "decimals": 0 } }
        },
        {
          "title": "Consumers",
          "type": "stat",
          "gridPos": { "h": 4, "w": 4, "x": 16, "y": 1 },
          "targets": [
            {
              "expr": "sum(rabbitmq_queue_consumers{namespace=\"rabbitmq\"})",
              "legendFormat": "Consumers"
            }
          ],
          "fieldConfig": { "defaults": { "unit": "short", "decimals": 0 } }
        },
        {
          "title": "Memory Used",
          "type": "stat",
          "gridPos": { "h": 4, "w": 4, "x": 20, "y": 1 },
          "targets": [
            {
              "expr": "rabbitmq_process_resident_memory_bytes{namespace=\"rabbitmq\"} / 1024 / 1024 / 1024",
              "legendFormat": "Memory"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "decgbytes",
              "decimals": 2,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "color": "green", "value": null },
                  { "color": "yellow", "value": 1.4 },
                  { "color": "red", "value": 1.8 }
                ]
              }
            }
          }
        },
        {
          "title": "üìà Message Rates",
          "type": "row",
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 5 },
          "collapsed": false
        },
        {
          "title": "Publish Rate",
          "type": "timeseries",
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 6 },
          "targets": [
            {
              "expr": "sum(rate(rabbitmq_channel_messages_published_total{namespace=\"rabbitmq\"}[1m]))",
              "legendFormat": "Published/s"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "ops",
              "custom": { "drawStyle": "line", "fillOpacity": 20 }
            }
          }
        },
        {
          "title": "Deliver/Ack Rate",
          "type": "timeseries",
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 6 },
          "targets": [
            {
              "expr": "sum(rate(rabbitmq_channel_messages_delivered_total{namespace=\"rabbitmq\"}[1m]))",
              "legendFormat": "Delivered/s"
            },
            {
              "expr": "sum(rate(rabbitmq_channel_messages_acked_total{namespace=\"rabbitmq\"}[1m]))",
              "legendFormat": "Acked/s"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "ops",
              "custom": { "drawStyle": "line", "fillOpacity": 20 }
            }
          }
        },
        {
          "title": "üì¶ Queue Details",
          "type": "row",
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 14 },
          "collapsed": false
        },
        {
          "title": "Messages per Queue",
          "type": "timeseries",
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 15 },
          "targets": [
            {
              "expr": "rabbitmq_queue_messages{namespace=\"rabbitmq\"}",
              "legendFormat": "{{queue}}"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short",
              "custom": { "drawStyle": "line", "fillOpacity": 10 }
            }
          }
        },
        {
          "title": "Queue Memory Usage",
          "type": "timeseries",
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 15 },
          "targets": [
            {
              "expr": "rabbitmq_queue_process_memory_bytes{namespace=\"rabbitmq\"} / 1024 / 1024",
              "legendFormat": "{{queue}}"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "decmbytes",
              "custom": { "drawStyle": "line", "fillOpacity": 10 }
            }
          }
        },
        {
          "title": "üö® Dead Letter Queues",
          "type": "row",
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 23 },
          "collapsed": false
        },
        {
          "title": "DLQ Messages",
          "type": "timeseries",
          "gridPos": { "h": 6, "w": 24, "x": 0, "y": 24 },
          "targets": [
            {
              "expr": "rabbitmq_queue_messages{namespace=\"rabbitmq\", queue=~\"dlq.*\"}",
              "legendFormat": "{{queue}}"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short",
              "custom": { "drawStyle": "bars", "fillOpacity": 50 },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "color": "green", "value": null },
                  { "color": "yellow", "value": 10 },
                  { "color": "red", "value": 50 }
                ]
              }
            }
          }
        }
      ]
    }
