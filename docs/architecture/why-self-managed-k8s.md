# ğŸ¯ Self-Managed Kubernetes ì„ íƒ ë°°ê²½

> **EKS ëŒ€ì‹  kubeadmì„ ì„ íƒí•œ ì´ìœ **  
> **ë‚ ì§œ**: 2025-10-31

## ğŸ“‹ ì˜ì‚¬ê²°ì • ìš”ì•½

### ìµœì¢… ì„ íƒ

```
âœ… Self-Managed Kubernetes (kubeadm)
âŒ AWS EKS
```

---

## ğŸ’° ë¹„ìš© ë¹„êµ

### EKS

```
Control Plane: $73/ì›” (ê³ ì •)
Worker Nodes: $180/ì›” (t3.large x3)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì´: $253/ì›”

ì¥ì :
âœ… ê´€ë¦¬í˜• Control Plane
âœ… ìë™ ì—…ê·¸ë ˆì´ë“œ
âœ… AWS í†µí•©
âœ… ê³ ê°€ìš©ì„± ë‚´ì¥

ë‹¨ì :
âš ï¸ ë¹„ìš© ë†’ìŒ (+$73/ì›”)
âš ï¸ í•™ìŠµ ê¸°íšŒ ì ìŒ
âš ï¸ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì œí•œ
```

### Self-Managed (ì„ íƒ)

```
Control Plane: $60/ì›” (t3.large Master í¬í•¨)
Worker Nodes: $120/ì›” (t3.medium x2 + t3.large x1)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì´: $180/ì›”

ì¥ì :
âœ… ë¹„ìš© ì ˆê° (-$73/ì›”, 29% ì ˆê°)
âœ… ì™„ì „í•œ ì œì–´
âœ… ê¹Šì€ í•™ìŠµ ê¸°íšŒ
âœ… ì»¤ìŠ¤í„°ë§ˆì´ì§• ììœ 

ë‹¨ì :
âš ï¸ ìˆ˜ë™ ê´€ë¦¬ í•„ìš”
âš ï¸ ì—…ê·¸ë ˆì´ë“œ ì§ì ‘ ìˆ˜í–‰
âš ï¸ HA ì§ì ‘ êµ¬ì„±
```

---

## ğŸ“ í•™ìŠµ ëª©ì 

### í•´ì»¤í†¤ + í•™ìŠµ í”„ë¡œì íŠ¸

```
ìš°ë¦¬ ìƒí™©:
- SeSAC êµìœ¡ ê³¼ì •
- ì‹¤ì „ ê²½í—˜ í•„ìš”
- Kubernetes ê¹Šì´ ì´í•´ í•„ìš”
- íŒ€ ì—­ëŸ‰ í–¥ìƒ

Self-Managedë¡œ ì–»ëŠ” ê²ƒ:
âœ… kubeadm ë§ˆìŠ¤í„°
âœ… etcd ì§ì ‘ ê´€ë¦¬
âœ… CNI ì„ íƒ ë° ì„¤ì • (Calico VXLAN)
âœ… Control Plane íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
âœ… ë³´ì•ˆ ê·¸ë£¹ ì„¤ê³„
âœ… ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹…
âœ… 59ì¼ê°„ì˜ ì‹¤ì „ ê²½í—˜!

â†’ ì´ë ¥ì„œì— ì“¸ ìˆ˜ ìˆëŠ” ì‹¤ì „ ê²½í—˜
â†’ Kubernetes ì „ë¬¸ê°€ë¡œ ì„±ì¥
```

---

## âš™ï¸ ê¸°ìˆ ì  ì´ìœ 

### 1. ì™„ì „í•œ ì œì–´

```
kubeadm:
- Control Plane ì ‘ê·¼ ê°€ëŠ¥
- etcd ì§ì ‘ ê´€ë¦¬
- API Server ì„¤ì • ë³€ê²½
- Scheduler ì •ì±… ì¡°ì •
- ëª¨ë“  ë¡œê·¸ ì ‘ê·¼

EKS:
- Control Plane ë¸”ë™ë°•ìŠ¤
- ì œí•œëœ ì„¤ì •ë§Œ ê°€ëŠ¥
- AWS ì •ì±… ë”°ë¼ì•¼ í•¨
```

### 2. ì»¤ìŠ¤í„°ë§ˆì´ì§•

```
ìš°ë¦¬ê°€ í•œ ê²ƒ:
âœ… Calico VXLAN (BGP ì™„ì „ ë¹„í™œì„±í™”)
âœ… control-plane-endpoint (HA ì¤€ë¹„)
âœ… kubeadm init phase addon (kube-proxy)
âœ… etcd ë°±ì—… ìë™í™”
âœ… block/rescue ì—ëŸ¬ ì²˜ë¦¬
âœ… 59ê°œ ê°œì„  ì»¤ë°‹

EKSì˜€ë‹¤ë©´:
â†’ ëŒ€ë¶€ë¶„ ë¶ˆê°€ëŠ¥í•˜ê±°ë‚˜ ì œí•œì 
```

### 3. ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ í–¥ìƒ

```
59ì¼ê°„ í•´ê²°í•œ ë¬¸ì œë“¤:
- containerd pause image ë¶ˆì¼ì¹˜
- Calico BGP vs VXLAN
- kube-proxy ConfigMap ì¶©ëŒ
- Service ë„¤íŠ¸ì›Œí‚¹ (UDP 4789)
- DNS íƒ€ì„ì•„ì›ƒ
- API ì„œë²„ ë¶ˆì•ˆì •
- etcd CrashLoopBackOff
- ...

EKS:
â†’ ëŒ€ë¶€ë¶„ ìë™ í•´ê²° (í•™ìŠµ ê¸°íšŒ ì—†ìŒ)
```

---

## ğŸ¯ 4-Tier Architecture ì§„í™”

### ì§„í™” ê³¼ì •

```
Phase 1: ì´ˆê¸° ì„¤ê³„ (3-node)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Master + Worker 2ê°œ
ëª¨ë“  ì„œë¹„ìŠ¤ í˜¼ì¬
ë¹„ìš©: $105/ì›”

ë¬¸ì œ:
âŒ ë¦¬ì†ŒìŠ¤ ê²½í•©
âŒ ì—­í•  ë¶ˆëª…í™•
âŒ í™•ì¥ì„± ì œí•œ

Phase 2: ìŠ¤í™ ìµœì í™” (3-node, t3.large)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ëª¨ë“  ë…¸ë“œ t3.large (8GB)
Prometheus ì•ˆì •ì„± í™•ë³´
ë¹„ìš©: $240/ì›”

ë¬¸ì œ:
âš ï¸ ë¹„ìš© ì¦ê°€
âš ï¸ ê³¼ë„í•œ ìŠ¤í™ (ì¼ë¶€)

Phase 3: Instagram íŒ¨í„´ ì ìš© (4-node) â­
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì—­í• ë³„ ë…¸ë“œ ë¶„ë¦¬:
1. Master (Control + Monitor)
2. Worker-1 (Application)
3. Worker-2 (Async Workers)
4. Storage (Stateful)

ë¹„ìš©: $180/ì›”
```

### ìµœì¢… 4-Tier

```
Tier 1: Control + Monitoring (Master)
- kube-apiserver, scheduler, controller
- etcd
- Prometheus, Grafana

Tier 2: Sync API (Worker-1)
- FastAPI Pods (Reactor Pattern)
- ì¦‰ì‹œ ì‘ë‹µ (<100ms)
- auth, users, locations

Tier 3: Async Workers (Worker-2)
- Celery Workers
- GPT-4o Vision ë¶„ì„
- ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬

Tier 4: Stateful Storage (Storage)
- RabbitMQ (HA 3-node)
- PostgreSQL
- Redis

ì¥ì :
âœ… ëª…í™•í•œ ì—­í•  ë¶„ë¦¬ (Robin íŒ¨í„´)
âœ… ë…ë¦½ ìŠ¤ì¼€ì¼ë§ (Instagram íŒ¨í„´)
âœ… ë¹„ìš© ìµœì í™” (-$60)
âœ… í”„ë¡œë•ì…˜ ì¤€ë¹„
```

---

## ğŸ“š ì°¸ê³ í•œ íŒ¨í„´

### Instagram Engineering

```
ì´ˆê¸°:
- Redis + Celery
- ë¹„ë™ê¸° ì²˜ë¦¬ ë¶„ë¦¬
- Worker Pool ì „ëµ

ì ìš©:
âœ… Celery Worker ë…ë¦½ Deployment
âœ… Queue ìš°ì„ ìˆœìœ„ ë¶„ë¦¬
âœ… Worker ë…¸ë“œ ë¶„ë¦¬
```

### Robin Storage

```
íŠ¹ì§•:
- Storage ê²©ë¦¬
- Control Plane ì•ˆì •ì„±
- Stateful ì„œë¹„ìŠ¤ ë³„ë„ ê´€ë¦¬

ì ìš©:
âœ… Storage ì „ìš© ë…¸ë“œ
âœ… RabbitMQ, PostgreSQL ê²©ë¦¬
âœ… etcd ë°±ì—… ìë™í™”
```

---

## ğŸ¯ ê²°ê³¼

### ë‹¬ì„±í•œ ê²ƒ

```
âœ… ë¹„ìš© íš¨ìœ¨: $180/ì›” (EKS ëŒ€ë¹„ 29% ì ˆê°)
âœ… í•™ìŠµ ê²½í—˜: 59ì¼ ì‹¤ì „ ë””ë²„ê¹…
âœ… í”„ë¡œë•ì…˜ê¸‰: ëª¨ë²” ì‚¬ë¡€ ì ìš©
âœ… í™•ì¥ ê°€ëŠ¥: ëª…í™•í•œ ì•„í‚¤í…ì²˜
âœ… ë¬¸ì„œí™”: 70+ ë¬¸ì„œ
âœ… ìë™í™”: 12ê°œ ìŠ¤í¬ë¦½íŠ¸

ê¸°ìˆ  ì—­ëŸ‰:
- Kubernetes ë‚´ë¶€ êµ¬ì¡° ì´í•´
- ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹… ëŠ¥ë ¥
- Infrastructure as Code ë§ˆìŠ¤í„°
- í”„ë¡œë•ì…˜ ìš´ì˜ ê²½í—˜
```

---

## ğŸ’¡ ì–¸ì œ EKSë¡œ ì „í™˜?

```
ì „í™˜ ì‹œì :
- ê·œëª¨: ë…¸ë“œ 20ê°œ ì´ìƒ
- íŒ€: ìš´ì˜íŒ€ ì—†ìŒ
- ë¹„ìš©: ê´€ë¦¬ ë¹„ìš© > $73/ì›”
- ìš”êµ¬ì‚¬í•­: 99.95% SLA

í˜„ì¬ëŠ”:
â†’ Self-Managedê°€ ìµœì  âœ…
â†’ í•™ìŠµ + ë¹„ìš© + ì œì–´
```

---

**ì‘ì„±ì¼**: 2025-10-31  
**ê²°ì •**: Self-Managed Kubernetes (kubeadm)  
**ë¹„ìš©**: $180/ì›” (EKS ëŒ€ë¹„ -$73/ì›”)

